# 多人协作看板应用

一个支持多用户实时协作的看板工具，具有项目组共享、文本文件存储和自动备份功能。

## 🚀 功能特点

### 核心功能
- **多用户协作**: 支持多人同时编辑同一个项目看板
- **项目组管理**: 用户加入项目组，共享看板数据
- **实时同步**: WebSocket实现实时数据同步
- **文本存储**: 使用JSON文件存储，易于备份和迁移

### 看板功能  
- **三列布局**: 待办 → 进行中 → 已完成
- **任务管理**: 添加、编辑、删除、移动任务
- **截止日期**: 支持设置任务截止时间，自动提醒
- **任务详情**: 标题、描述、创建者、时间信息

### 协作功能
- **在线用户**: 显示项目组内在线用户
- **编辑提示**: 显示正在编辑的用户和任务
- **实时更新**: 所有操作实时同步到所有用户

### 数据安全
- **自动备份**: 每次修改自动创建备份
- **版本管理**: 保留最近50个备份文件
- **定期清理**: 自动清理过期备份

### 导出功能
- **Markdown导出**: 将看板数据导出为Markdown格式
- **结构化输出**: 包含任务详情、时间信息等

## 📁 项目结构

```
kanban/
├── public/                 # 前端文件
│   ├── index.html         # 主页面
│   ├── style.css          # 样式文件
│   └── app.js             # 前端逻辑
├── server.js              # Express服务器
├── package.json           # 项目配置
└── data/                  # 数据存储目录
    ├── users.txt          # 用户数据
    ├── {项目组}.txt       # 各项目组看板数据
    └── backups/           # 备份目录
```

## 🛠️ 安装和运行

### 1. 安装依赖
```bash
npm install
```

### 2. 启动服务器
```bash
# 默认端口3000
npm start

# 或指定端口
PORT=3001 node server.js
```

### 3. 访问应用
打开浏览器访问: http://localhost:3001

## 📋 使用说明

### 1. 用户注册/登录
- 输入用户名、密码和项目组名称
- 首次使用选择"注册"
- 相同项目组的用户可以共享看板

### 2. 看板操作
- **添加任务**: 在对应列底部输入标题和截止日期
- **编辑任务**: 点击任务卡片进入编辑模式
- **移动任务**: 使用卡片上的左右箭头按钮
- **删除任务**: 在编辑模式中点击删除按钮

### 3. 协作功能
- 右上角显示在线用户数量和列表
- 正在编辑的任务会有特殊标识
- 所有操作实时同步到其他用户

### 4. 数据导出
- 点击"导出Markdown"按钮
- 自动下载包含所有任务的Markdown文件

## 🔧 技术栈

- **前端**: 原生JavaScript + CSS
- **后端**: Node.js + Express
- **实时通信**: WebSocket (ws库)
- **数据存储**: JSON文本文件
- **用户认证**: SHA256密码哈希

## 📝 数据格式

### 用户数据 (users.txt)
```json
{
  "用户名": {
    "password": "哈希密码",
    "groups": ["项目组1", "项目组2"],
    "created": "创建时间"
  }
}
```

### 看板数据 (项目组.txt)
```json
{
  "todo": [
    {
      "id": "任务ID",
      "title": "任务标题",
      "description": "任务描述",
      "author": "创建者",
      "created": "创建时间",
      "deadline": "截止时间"
    }
  ],
  "doing": [...],
  "done": [...]
}
```

## 🔄 备份策略

- **自动备份**: 每次数据修改都会创建备份
- **文件命名**: `项目组-时间戳.txt`
- **保留策略**: 每个项目组保留最近50个备份
- **清理机制**: 每小时自动清理过期备份

## 🚦 部署建议

### 开发环境
```bash
PORT=3001 node server.js
```

### 生产环境
1. 使用PM2或类似工具管理进程
2. 配置反向代理(Nginx)
3. 设置数据目录权限
4. 定期备份data目录

### 安全建议
- 在生产环境中使用HTTPS
- 定期备份data目录到其他位置
- 考虑使用更强的密码哈希算法
- 添加用户访问频率限制

## 📞 故障排除

### 端口占用
如果3000端口被占用，使用其他端口：
```bash
PORT=3001 node server.js
```

### 数据恢复
从备份恢复数据：
1. 找到对应的备份文件
2. 复制到data目录并重命名
3. 重启服务器

### WebSocket连接问题
- 检查防火墙设置
- 确认WebSocket支持
- 查看浏览器控制台错误信息

## 🎯 功能演示

当前服务器已在端口3001启动，可以：
1. 访问 http://localhost:3001
2. 注册多个用户到同一项目组
3. 在不同浏览器窗口中测试实时协作
4. 尝试添加、编辑、移动任务
5. 测试Markdown导出功能

开发完成！✅